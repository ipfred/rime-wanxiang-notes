# 目录结构与核心文件（看懂就敢改）

下面按“你最可能需要改的”优先级来解释。

## 1) 方案入口：`*.schema.yaml`

你最终在输入法里勾选的是 schema：

- `wanxiang.schema.yaml`：万象拼音（标准版）
- `wanxiang_pro.schema.yaml`：万象拼音（增强版/PRO，源项目提供）
- 其他：`wanxiang_english.schema.yaml`、`wanxiang_mixedcode.schema.yaml`、`wanxiang_reverse.schema.yaml`、`wanxiang_t9.schema.yaml`

schema 里会引用词库、Lua、OpenCC、以及各种开关/处理链（`processors/segmentors/translators/filters`）。

## 2) 词库入口：`*.dict.yaml` + `dicts/`

常见关系是：

- `wanxiang.dict.yaml`（主词库入口文件）
- `dicts/`（分拆的词库数据：基础词、联想、诗词、地名、英文…）

你通常不需要直接改这些词库文件；更推荐用自定义词库（见下文）。

## 3) 你自己的配置：`*.custom.yaml`（最重要）

**custom patch = 最终覆盖层**，优先级最高，更新也不会覆盖它。

常用文件：

- `wanxiang.custom.yaml`：标准版补丁（生效位置：用户目录根目录）
- `wanxiang_pro.custom.yaml`：PRO 补丁（生效位置：用户目录根目录）
- `wanxiang_reverse.custom.yaml` / `wanxiang_english.custom.yaml` / `wanxiang_mixedcode.custom.yaml`：配套 schema 的补丁

注意：

- “方案包/源仓库”里的 `custom/` 目录只是“携带/初始化样例”，真正生效位置是 **用户目录根目录**（源 README 也强调了这一点）。
- patch 写法参考：`10-patch方法论.md`

## 4) Lua 扩展：`lua/`

万象大量功能来自 Lua（例如：指令切换方案、Tips、手动排序、超级注释、日期时间、计算器…）。

你不需要读完所有 Lua；当你想改某个行为时，再定位到对应文件：

- `/pinyin /flypy ...` 切换方案：`lua/set_schema.lua`
- 时间日期等：`lua/shijian.lua`
- Tips：`lua/super_tips.lua`
- 超级注释/预编辑：`lua/super_comment_preedit.lua`

## 5) OpenCC：`opencc/`

用于 Emoji、翻译、简繁等过滤/转换数据（具体链路在 schema 里能看到对应 `simplifier@...`）。

## 6) 全局默认与前端配置：`default.yaml` / `weasel.yaml`

- `default.yaml`：全局行为（方案列表、快捷键、候选数量等“通用项”）
- `weasel.yaml`：Windows 小狼毫专用（皮肤、字体、应用单独设置等）

一般建议：前端相关放在对应前端文件（如 `weasel.yaml`），方案相关尽量放 `wanxiang.custom.yaml`。
